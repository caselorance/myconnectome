---
title: "Timeseries analyses for MyConnectome Project"
author: "Russ Poldrack"
date: "November 1, 2014"
output: html_document
---

This notebook runs all of the timeseries analyses presented in the MyConnectome paper. Note that this set of analyses will take a good bit of time to run (> 15 mins on a laptop).

First we need to load some relevant libraries:

```{r message=FALSE}
library(forecast)
library(knitr)
source('http://s3.amazonaws.com/openfmri/ds031/timeseries_analyses/load_myconnectome_data.R')
source('http://s3.amazonaws.com/openfmri/ds031/timeseries_analyses/est_bivariate_arima_model.R')

save_latex=TRUE
```

Make a wrapper for kable that can detect empty datasets

```{r}
kable_wrap = function(data,fdr_thresh=0.1) {
  data = data[data$pval_bh<fdr_thresh,]
  if (nrow(data)>0) {kable(data)} else {print('no significant results')}
}

```

Make a function to generate latex tables.
```{r}
kable_latex = function(data,varname,tabledir='/Users/poldrack/Dropbox/Documents/Papers/SelfTracking/timeseries_analysis_tables') {
    if (nrow(data) > 30) {lt=TRUE} else {lt=FALSE}
    k=kable(data,format='latex',longtable=lt,digits=3,row.names=FALSE)
    write(k,file=sprintf('%s/%s_timeseries_stats.tex',tabledir,varname))
}
```

Make a function to output the results to the appropriate file.

```{r}
output_results=function(d,vnames,fdr_thresh=0.1,save_latex=TRUE,save_table=TRUE,OUTPUT_DIR='/tmp') {
  vname=sprintf('%s_%s',vnames[1],vnames[2])
  ds=d[d$pval_bh<fdr_thresh,]
  ds=subset(ds,select=c(xvar,yvar,cor.val,t.arima,pval_bh,nobs))
  names(ds)=c(sprintf("X:%s",vnames[1]),sprintf("Y:%s",vnames[2]),'r','t','p (BH)','N')
  if (save_table) {
    write.table(d,file=paste(OUTPUT_DIR,sprintf('out.dat.%s.txt',vname),sep='/'))
  }
  if (save_latex) {
    kable_latex(ds,vname)
  }
}
```

If you would like your results to be put into a specific place, then set the variable OUTPUT_DIR to that value.  This puts them in a specific place on my computer.

```{r}

if (file.exists('/Users/poldrack/Dropbox/data/selftracking/timeseries_analyses')) {
  print("Looks like we are on Russ's computer, using default OUTPUT_DIR")
	OUTPUT_DIR='/Users/poldrack/Dropbox/data/selftracking/timeseries_analyses'
}

if (!exists('OUTPUT_DIR')) {
	print('To save results to a specific directory, set OUTPUT_DIR variable to target directory')
	OUTPUT_DIR=NULL 
} else{
	print(c('Saving results to:',OUTPUT_DIR))
}
	
if (is.null(OUTPUT_DIR)) {
	OUTPUT_DIR='timeseries_results'
	print('creating output directory: ./timeseries_results')
	dir.create(OUTPUT_DIR)
	}

```


Load all of the relevant data, changing the variable names as needed.

```{r message=FALSE,warning=FALSE,error=FALSE}
behav=load_behav_data()
wincorr=load_fmri_data('wincorr')
bwcorr=load_fmri_data('bwcorr')


fd=load_fd_data()
food=load_food_data()
rnaseq_wgcna=load_rnaseq_data(limit_ME_to_enriched=FALSE)
metab=load_metab_data()
data_names=c()
for (i in 1:(dim(metab)[2]-1)) {
    data_names=rbind(data_names,sprintf('C%d:%s',i,names(metab)[i]))
  	}
data_names=rbind(data_names,'date')
names(metab)=data_names


fullmetab=load_metab_data(use_clustered_data=FALSE)
data_names=c()
for (i in 1:(dim(fullmetab)[2]-1)) {
    n=gsub('_NIST','',names(fullmetab)[i])
    n=gsub('_',' ',n)

    data_names=rbind(data_names,n)
    }
data_names=rbind(data_names,'date')
names(fullmetab)=data_names


immport=load_ImmPort_data()

```

Create the subset of data that we are interested in for the behavioral analysis - generate a version without the tuesday/thursday variable for use with the blood data (which are only on tuesdays)

```{r}
xvars=c('panas.positive','panas.negative','panas.fatigue','afterscan.Anxietyduringscan','afterscan.diastolic','afterscan.pulse','afterscan.systolic','morning.Sleepquality','morning.Soreness','prevevening.Alcohol','prevevening.Guthealth','prevevening.Psoriasisseverity','prevevening.Stress', 'prevevening.Timespentoutdoors','TuesThurs', 'temp.mean',"email.LIWCcdi","email.LIWCnegemo","email.LIWCposemo",'zeo.zq')

behav_keep=subset(behav,select=c(xvars,'date'))
behav_keep_no_tth=subset(behav_keep,select=-TuesThurs)
```

## Run regression models
For each set of variables, run the regression model and save outputs.


####Behavioral variables vs. each other:

```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('behav','behav')
if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {
d=est_bivariate_arima_model(behav_keep, behav_keep,spacing='1 day',skip_ident=TRUE)
}
```

```{r  results="asis"}
kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####Within-module connectivity vs. behavior

```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wincorr','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {
    d=est_bivariate_arima_model(wincorr,behav_keep)
    }
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####Between-module connectivity vs. behavior

```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('bwcorr','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(bwcorr,behav_keep)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```


####Behavior vs. RNA-seq:


```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wgcna','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna,behav_keep_no_tth,spacing='1 week')}
```


```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)


```

#### Within-module connectivity vs. RNA-seq
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wgcna','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna,wincorr,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### Between-module connectivity vs. RNA-seq
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wgcna','bwcorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna,bwcorr,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```



####ImmPort immune genes vs behavior

```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('immport','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(immport,behav_keep_no_tth,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### Test specific hypothesis regarding psoriasis
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('psoriasis','immport')
psoriasis=subset(behav,select=c(date,prevevening.Psoriasisseverity))
if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(immport,psoriasis,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```



####ImmPort immune genes vs within-module connectivity

```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('immport','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(immport,wincorr,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####ImmPort immune genes vs food
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('food','immport')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,immport,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####ImmPort immune genes vs metabolism
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('immport','metab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(immport,metab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####ImmPort immune genes vs metabolism (full set)
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('immport','fullmetab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(immport,fullmetab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```



#### food vs. metabolism
note: food needs to be X variable because auto.arima doesn't handle binary Y variable
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('food','metab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,metab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### food vs. metabolism (individual metabolites)
note: food needs to be X variable because auto.arima doesn't handle binary Y variable
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('food','fullmetab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,fullmetab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```


#### behav vs. metabolsm
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('behav','metab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(behav_keep_no_tth,metab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### behav vs. metabolsm (full set)
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('behav','fullmetab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(behav_keep_no_tth,fullmetab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```


####metabolism vs. within-network connectivity
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('metab','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(metab,wincorr,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

####metabolism vs. within-network connectivity (full set of metabolites)
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('fullmetab','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(fullmetab,wincorr,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```



#### within-network connectivity 
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wincorr','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(wincorr,wincorr,skip_ident=TRUE)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```



#### food vs. within-network connectivity
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('food','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,wincorr)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### food vs. behavior
Remove food variables that have too many zeros or ones, otherwise will fail

```{r message=FALSE,warning=FALSE,error=FALSE}
food$apples=NULL  
food$blueberries=NULL
behav_keep_no_tth$zeo.zq=NULL

vnames=c('food','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,behav_keep_no_tth)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### compare head motion to other measures

#### FD vs. behavior
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('fd','behav')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(fd,behav_keep)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### FD vs. RNA-seq
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('fd','wgcna')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(fd,rnaseq_wgcna,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### FD vs. metabolites

```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('fd','metab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(fd,metab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### FD vs. wincorr
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('fd','wincorr')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(fd,wincorr)}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```


#### RNA-seq 


```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('wgcna','wgcna')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna, rnaseq_wgcna,spacing='1 week',skip_ident=TRUE)}
```

```{r  results="asis"}
# turning off output because there are too many significant results here - uncomment to turn it back on
#kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### RNA-seq vs. metabolism
```{r message=FALSE,warning=FALSE,error=FALSE}
vnames=c('wgcna','metab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna,metab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

#### RNA-seq vs. metabolism (full set)
```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('wgcna','fullmetab')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(rnaseq_wgcna,fullmetab,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```


#### RNA-seq vs. food


```{r message=FALSE,warning=FALSE,error=FALSE}

vnames=c('food','wgcna')

if (file.exists(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))) {
  print("loading existing file...")
  d=read.table(paste(OUTPUT_DIR,sprintf('out.dat.%s_%s.txt',vnames[1],vnames[2]),sep='/'))
  } else {d=est_bivariate_arima_model(food,rnaseq_wgcna,spacing='1 week')}
```

```{r  results="asis"}

kable_wrap(d)
output_results(d,vnames,OUTPUT_DIR=OUTPUT_DIR)

```

